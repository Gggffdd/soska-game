<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <title>Number Chase</title>
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
            touch-action: none;
        }
        
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .hidden {
            display: none !important;
        }
        
        #gameCanvas {
            display: block;
            width: 100%;
            height: 100%;
            background: #1a1a2e;
        }
        
        /* –ú–µ–Ω—é */
        .menu-content {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 2em;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin: 1em;
            color: white;
        }
        
        .menu-content h1 {
            font-size: 2em;
            margin-bottom: 0.5em;
        }
        
        .menu-btn {
            padding: 1em 2em;
            font-size: 1.1em;
            background: #ff6b6b;
            border: none;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            margin: 0.5em;
            width: 200px;
            display: block;
        }
        
        /* HUD */
        #gameHUD {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .hud-top {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            justify-content: space-between;
            color: white;
            font-size: 1em;
        }
        
        .health-indicators {
            display: flex;
            gap: 5px;
        }
        
        .health-indicator {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .health-indicator.active {
            background: #feca57;
        }
        
        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        #touchControls {
            position: absolute;
            bottom: 10px;
            left: 0;
            right: 0;
            height: 100px;
            pointer-events: none;
        }
        
        .touch-area {
            position: absolute;
            left: 10px;
            bottom: 0;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            pointer-events: auto;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .action-buttons {
            position: absolute;
            right: 10px;
            bottom: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: auto;
        }
        
        .action-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            font-size: 1.5em;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loadingScreen" class="screen">
            <div class="menu-content">
                <h1>NUMBER CHASE</h1>
                <div id="loadingStatus">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <button class="menu-btn" onclick="skipLoading()">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É</button>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="mainMenu" class="screen hidden">
            <div class="menu-content">
                <h1>NUMBER CHASE</h1>
                <p style="margin-bottom: 1em; color: rgba(255,255,255,0.8);">–ë–µ–≥–∏ –æ—Ç —á–∏—Å–ª–∞ 69!</p>
                <button class="menu-btn" onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                <button class="menu-btn" onclick="showInstructions()">–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</button>
            </div>
        </div>

        <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
        <div id="instructionsScreen" class="screen hidden">
            <div class="menu-content">
                <h1>–ö–ê–ö –ò–ì–†–ê–¢–¨</h1>
                <div style="text-align: left; margin: 1em 0;">
                    <p>‚Ä¢ –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –ø–∞–ª–µ—Ü –≤ –ª–µ–≤–æ–π –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è</p>
                    <p>‚Ä¢ –ù–∞–∂–∏–º–∞–π—Ç–µ –ø—Ä–∞–≤—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –±–∞—Ä—å–µ—Ä–∞</p>
                    <p>‚Ä¢ –°–æ–±–∏—Ä–∞–π—Ç–µ –∂–µ–ª—Ç—ã–µ —â–∏—Ç—ã –¥–ª—è –∑–∞—â–∏—Ç—ã</p>
                    <p>‚Ä¢ –ë–µ–≥–∏—Ç–µ –æ—Ç —á–∏—Å–ª–∞ 69!</p>
                </div>
                <button class="menu-btn" onclick="showMainMenu()">–ù–∞–∑–∞–¥</button>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="gameScreen" class="screen hidden">
            <canvas id="gameCanvas"></canvas>
            
            <div id="gameHUD">
                <div class="hud-top">
                    <div class="score-display">
                        <span>–í—Ä–µ–º—è: </span>
                        <span id="timer">0</span>
                    </div>
                    <div class="health-indicators" id="healthIndicators">
                        <div class="health-indicator"></div>
                        <div class="health-indicator"></div>
                        <div class="health-indicator"></div>
                    </div>
                </div>
                
                <div id="touchControls">
                    <div class="touch-area" id="moveArea"></div>
                    <div class="action-buttons">
                        <button class="action-btn" id="useBarrier">üõ°Ô∏è</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Over -->
        <div id="gameOverScreen" class="screen hidden">
            <div class="menu-content">
                <h1>GAME OVER</h1>
                <p>–í—Ä–µ–º—è: <span id="finalTime">0</span></p>
                <button class="menu-btn" onclick="restartGame()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                <button class="menu-btn" onclick="showMainMenu()">–í –º–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let game = null;
        let gameTime = 0;
        let gameInterval = null;
        let player = { x: 0, y: 0, barriers: 0 };
        let enemy = { x: 0, y: 0 };
        let barriers = [];
        
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–≥—Ä—ã
        const GameConstants = {
            PLAYER_SIZE: 15,
            ENEMY_SIZE: 30,
            BARRIER_SIZE: 10,
            PLAYER_SPEED: 3
        };
        
        // –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function skipLoading() {
            showMainMenu();
        }
        
        function showMainMenu() {
            hideAllScreens();
            document.getElementById('mainMenu').classList.remove('hidden');
        }
        
        function showInstructions() {
            hideAllScreens();
            document.getElementById('instructionsScreen').classList.remove('hidden');
        }
        
        function hideAllScreens() {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function startGame() {
            console.log('Starting game...');
            hideAllScreens();
            document.getElementById('gameScreen').classList.remove('hidden');
            
            initializeGame();
            startGameLoop();
        }
        
        function initializeGame() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
            player = {
                x: canvas.width / 2,
                y: canvas.height / 2,
                size: GameConstants.PLAYER_SIZE,
                color: '#48dbfb',
                barriers: 0,
                speed: GameConstants.PLAYER_SPEED
            };
            
            enemy = {
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: GameConstants.ENEMY_SIZE,
                color: '#ff6b6b',
                speed: 2
            };
            
            barriers = [];
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            initControls();
            
            console.log('Game initialized');
        }
        
        function initControls() {
            const touchArea = document.getElementById('moveArea');
            const barrierBtn = document.getElementById('useBarrier');
            let isMoving = false;
            let moveX = 0;
            let moveY = 0;
            
            // Touch —Å–æ–±—ã—Ç–∏—è –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è
            touchArea.addEventListener('touchstart', handleTouch);
            touchArea.addEventListener('touchmove', handleTouch);
            touchArea.addEventListener('touchend', stopMove);
            
            // Mouse —Å–æ–±—ã—Ç–∏—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞
            touchArea.addEventListener('mousedown', handleMouse);
            touchArea.addEventListener('mousemove', handleMouse);
            touchArea.addEventListener('mouseup', stopMove);
            touchArea.addEventListener('mouseleave', stopMove);
            
            // –ö–Ω–æ–ø–∫–∞ –±–∞—Ä—å–µ—Ä–∞
            barrierBtn.addEventListener('click', useBarrier);
            barrierBtn.addEventListener('touchstart', useBarrier);
            
            function handleTouch(e) {
                e.preventDefault();
                const rect = touchArea.getBoundingClientRect();
                const touch = e.touches[0];
                calculateMovement(touch.clientX - rect.left, touch.clientY - rect.top);
            }
            
            function handleMouse(e) {
                if (e.buttons === 1) {
                    const rect = touchArea.getBoundingClientRect();
                    calculateMovement(e.clientX - rect.left, e.clientY - rect.top);
                }
            }
            
            function calculateMovement(x, y) {
                const centerX = 50;
                const centerY = 50;
                
                moveX = (x - centerX) / 50;
                moveY = (y - centerY) / 50;
                
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
                const length = Math.sqrt(moveX * moveX + moveY * moveY);
                if (length > 1) {
                    moveX /= length;
                    moveY /= length;
                }
                
                isMoving = true;
            }
            
            function stopMove() {
                isMoving = false;
                moveX = 0;
                moveY = 0;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
            window.gameMoveState = { isMoving, moveX, moveY };
            
            setInterval(() => {
                window.gameMoveState = { isMoving, moveX, moveY };
            }, 16);
        }
        
        function useBarrier() {
            if (player.barriers > 0) {
                player.barriers--;
                updateHealthDisplay();
                // –≠—Ñ—Ñ–µ–∫—Ç –±–∞—Ä—å–µ—Ä–∞ - 3 —Å–µ–∫—É–Ω–¥—ã –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç–∏
                player.invulnerable = 180;
            }
        }
        
        function updateHealthDisplay() {
            const indicators = document.querySelectorAll('.health-indicator');
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index < player.barriers);
            });
        }
        
        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function startGameLoop() {
            gameTime = 0;
            updateTimer();
            
            gameInterval = setInterval(() => {
                updateGame();
                renderGame();
                gameTime += 1/60;
                
                if (Math.floor(gameTime) % 1 === 0) {
                    updateTimer();
                }
            }, 16); // ~60 FPS
        }
        
        function updateGame() {
            const canvas = document.getElementById('gameCanvas');
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
            if (window.gameMoveState && window.gameMoveState.isMoving) {
                player.x += window.gameMoveState.moveX * player.speed;
                player.y += window.gameMoveState.moveY * player.speed;
                
                // –ì—Ä–∞–Ω–∏—Ü—ã
                player.x = Math.max(player.size, Math.min(player.x, canvas.width - player.size));
                player.y = Math.max(player.size, Math.min(player.y, canvas.height - player.size));
            }
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–∞
            const dx = player.x - enemy.x;
            const dy = player.y - enemy.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 0) {
                enemy.x += (dx / distance) * enemy.speed;
                enemy.y += (dy / distance) * enemy.speed;
            }
            
            // –°–ø–∞–≤–Ω –±–∞—Ä—å–µ—Ä–æ–≤
            if (Math.random() < 0.01 && barriers.length < 5) {
                barriers.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: GameConstants.BARRIER_SIZE,
                    color: '#feca57'
                });
            }
            
            // –ö–æ–ª–ª–µ–∫—Ü–∏—è –±–∞—Ä—å–µ—Ä–æ–≤
            for (let i = barriers.length - 1; i >= 0; i--) {
                const barrier = barriers[i];
                const dist = Math.sqrt(
                    Math.pow(player.x - barrier.x, 2) + 
                    Math.pow(player.y - barrier.y, 2)
                );
                
                if (dist < player.size + barrier.size && player.barriers < 3) {
                    player.barriers++;
                    barriers.splice(i, 1);
                    updateHealthDisplay();
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –≤—Ä–∞–≥–æ–º
            if (!player.invulnerable) {
                const distToEnemy = Math.sqrt(
                    Math.pow(player.x - enemy.x, 2) + 
                    Math.pow(player.y - enemy.y, 2)
                );
                
                if (distToEnemy < player.size + enemy.size) {
                    gameOver();
                }
            }
            
            // –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç–∏
            if (player.invulnerable) {
                player.invulnerable--;
            }
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            if (gameTime > 30) {
                enemy.speed = 2 + (gameTime - 30) / 30;
            }
        }
        
        function renderGame() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            // –û—á–∏—Å—Ç–∫–∞
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –°–µ—Ç–∫–∞
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 1;
            for (let x = 0; x < canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y < canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
            
            // –ë–∞—Ä—å–µ—Ä—ã
            barriers.forEach(barrier => {
                ctx.fillStyle = barrier.color;
                ctx.beginPath();
                ctx.arc(barrier.x, barrier.y, barrier.size, 0, Math.PI * 2);
                ctx.fill();
                
                // –ò–∫–æ–Ω–∫–∞ —â–∏—Ç–∞
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.moveTo(barrier.x, barrier.y - barrier.size * 0.6);
                ctx.lineTo(barrier.x + barrier.size * 0.4, barrier.y - barrier.size * 0.2);
                ctx.lineTo(barrier.x + barrier.size * 0.4, barrier.y + barrier.size * 0.4);
                ctx.lineTo(barrier.x - barrier.size * 0.4, barrier.y + barrier.size * 0.4);
                ctx.lineTo(barrier.x - barrier.size * 0.4, barrier.y - barrier.size * 0.2);
                ctx.closePath();
                ctx.fill();
            });
            
            // –ò–≥—Ä–æ–∫
            ctx.fillStyle = player.invulnerable ? '#ffffff' : player.color;
            ctx.beginPath();
            ctx.arc(player.x, player.y, player.size, 0, Math.PI * 2);
            ctx.fill();
            
            // –õ–∏—Ü–æ –∏–≥—Ä–æ–∫–∞
            ctx.fillStyle = '#000000';
            ctx.beginPath();
            ctx.arc(player.x - 4, player.y - 3, 3, 0, Math.PI * 2);
            ctx.arc(player.x + 4, player.y - 3, 3, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(player.x, player.y + 4, 2, 0, Math.PI);
            ctx.stroke();
            
            // –í—Ä–∞–≥ (—á–∏—Å–ª–æ 69)
            ctx.fillStyle = enemy.color;
            ctx.beginPath();
            ctx.arc(enemy.x, enemy.y, enemy.size, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold ' + (enemy.size * 0.8) + 'px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('69', enemy.x, enemy.y);
            
            // –ì–ª–∞–∑–∞ –≤—Ä–∞–≥–∞
            ctx.fillStyle = '#000000';
            ctx.beginPath();
            ctx.arc(enemy.x - enemy.size * 0.3, enemy.y - enemy.size * 0.2, enemy.size * 0.1, 0, Math.PI * 2);
            ctx.arc(enemy.x + enemy.size * 0.3, enemy.y - enemy.size * 0.2, enemy.size * 0.1, 0, Math.PI * 2);
            ctx.fill();
        }
        
        function updateTimer() {
            const minutes = Math.floor(gameTime / 60);
            const seconds = Math.floor(gameTime % 60);
            document.getElementById('timer').textContent = 
                minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
        }
        
        function gameOver() {
            clearInterval(gameInterval);
            document.getElementById('finalTime').textContent = document.getElementById('timer').textContent;
            hideAllScreens();
            document.getElementById('gameOverScreen').classList.remove('hidden');
        }
        
        function restartGame() {
            clearInterval(gameInterval);
            startGame();
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫
        window.addEventListener('load', function() {
            console.log('Page loaded');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
                document.getElementById('mainMenu').classList.remove('hidden');
            }, 1000);
        });
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });
    </script>
</body>
</html>
